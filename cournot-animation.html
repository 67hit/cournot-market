<!DOCTYPE html>
<html>
<script src="https://d3js.org/d3.v7.min.js"></script>
<body>
<h2>Cournot Market</h2>
<svg id="myPlot" style="width:600px;height:600px"></svg>
</body>
<script>

// M - c
const MAX = 600

// Set Dimensions
const xSize = MAX;
const ySize = MAX;
const margin = 50;
const xMax = xSize - margin*2;
const yMax = ySize - margin*2;

// Line generator, based on coordinates
const line = d3.line()
  .x(d => x(d[0]))
  .y(d => y(d[1]))

const data1 = [[0,300],[600,0]]
const data2 = [[0,600],[300,0]]

// X Axis scaling function
const x = d3.scaleLinear()
  .domain([0, xSize])
  .range([0, xMax]);

const xinv = d3.scaleLinear()
  .domain([0, xMax])
  .range([0, xSize]);


// Y Axis scaling function
const y = d3.scaleLinear()
  .domain([0, ySize])
  .range([yMax, 0]);

  const yinv = d3.scaleLinear()
  .domain([yMax, 0])
  .range([0, ySize]);

const next_point = point => [0.5*(MAX-point[1]),0.5*(MAX-point[0])];

// Create Random Points
const numPoints = 10;
const data = [];
point = [Math.random() * MAX, Math.random() * MAX]
console.log(point)
for (let i = 0; i < numPoints; i++) {
  data.push(point);
  point = next_point(point)
}

// Append SVG Object to the Page
const svg = d3.select("#myPlot")
  .append("svg")
  .attr("id", "chart")
  .append("g")
  .attr("transform",`translate(${margin},${margin})`);

svg.append("g")
  .attr("transform", `translate(0,${yMax})`)
  .call(d3.axisBottom(x));

svg.append("g")
  .call(d3.axisLeft(y));

// Dots
svg.append('g')
  .selectAll("dot")
  .data(data).enter()
  .append("circle")
  .attr("cx", d => x(d[0]) )
  .attr("cy", d => y(d[1]) )
  .attr("r", 3)
  .style("fill", "Red");

// Two crossing lines
svg.append("path")
    .datum(data1)
    .attr("fill", "none")
    .attr("stroke", "steelblue")
    .attr("stroke-width", 1.5)
    .attr("d", line);

svg.append("path")
    .datum(data2)
    .attr("fill", "none")
    .attr("stroke", "orange")
    .attr("stroke-width", 1.5)
    .attr("d", line);


svg.append("path")
    .datum(data)
    .attr("fill", "none")
    .attr("stroke", "red")
    .attr("stroke-width", 1.5)
    .attr("d", line);

d3.select("#myPlot")
  .on('click', function(event)
    { var pos = d3.pointer(event,"#chart");
      console.log(pos);
    });

</script>
</html>